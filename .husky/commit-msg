#!/bin/bash

# Commit-msg hook
# ì»¤ë°‹ ë©”ì‹œì§€ ê²€ì¦ì„ ìœ„í•œ ê°„ë‹¨í•œ ìŠ¤í¬ë¦½íŠ¸

commit_msg_file="$1"
commit_msg=$(cat "$commit_msg_file")

echo ""
echo "ğŸ“ ================ ì»¤ë°‹ ë©”ì‹œì§€ ê²€ì¦ ================"
echo "ğŸ’¬ ì»¤ë°‹ ë©”ì‹œì§€: $commit_msg"

# ê¸°ë³¸ ê·œì¹™ (Conventional Commits)
basic_pattern="^(feat|fix|docs|style|refactor|test|chore|perf|main)(\(.+\))?: .{1,100}"
merge_pattern="^Merge (branch|pull request)"

# Merge ì»¤ë°‹ì€ í—ˆìš©
case "$commit_msg" in
    Merge\ branch*|Merge\ pull\ request*)
        echo "âœ… Merge ì»¤ë°‹ì…ë‹ˆë‹¤."
        echo "ğŸ‰ ì»¤ë°‹ ë©”ì‹œì§€ ê²€ì¦ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!"
        echo "=================================================="
        exit 0
        ;;
esac

# ê¸°ë³¸ íŒ¨í„´ ê²€ì¦ (ê°„ë‹¨í•œ í˜•íƒœë¡œ)
case "$commit_msg" in
    feat\(*|fix\(*|docs\(*|style\(*|refactor\(*|test\(*|chore\(*|perf\(*|main\(*)
        echo "âœ… ì»¤ë°‹ ë©”ì‹œì§€ í˜•ì‹ì´ ì˜¬ë°”ë¦…ë‹ˆë‹¤."
        echo "ğŸ‰ ì»¤ë°‹ ë©”ì‹œì§€ ê²€ì¦ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!"
        echo "=================================================="
        exit 0
        ;;
    *)
        echo ""
        echo "âŒ ê¸°ë³¸ ì»¤ë°‹ ë©”ì‹œì§€ ê·œì¹™ ìœ„ë°˜!"
        echo "ğŸ“‹ í˜•ì‹: type(scope): description"
        echo "âœ… ì˜ˆì‹œ: feat(auth): ì‚¬ìš©ì ë¡œê·¸ì¸ ê¸°ëŠ¥ ì¶”ê°€"
        echo "âœ… ì˜ˆì‹œ: main(api-server,client): base setup"
        echo "=================================================="
        exit 1
        ;;
esac
